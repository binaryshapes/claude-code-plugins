# TypeScript CLI Tool Tasks
# Inherited by all TypeScript CLI tools (Moon v2)

inheritedBy:
  toolchains: ['typescript']
  layers: ['tool']

fileGroups:
  sources:
    - 'src/**/*.{ts,tsx}'
    - 'lib/**/*.{ts,tsx}'
  tests:
    - 'tests/**/*.{ts,tsx}'
    - '**/*.test.{ts,tsx}'
    - '**/*.spec.{ts,tsx}'
    - '__tests__/**/*.{ts,tsx}'
  configs:
    - 'tsconfig.json'
    - 'tsconfig.*.json'
    - '*.config.{ts,js,mjs,cjs}'

implicitInputs:
  - 'package.json'

tasks:
  dev:
    command: 'pnpm dev'
    options:
      persistent: true

  build:
    command: 'pnpm build'
    inputs:
      - '@group(sources)'
      - '@group(configs)'
    outputs:
      - 'dist/**/*'

  lint:
    command: 'pnpm lint'
    inputs:
      - '@group(sources)'

  typecheck:
    command: 'pnpm typecheck'
    inputs:
      - '@group(sources)'
      - '@group(configs)'

  test:
    command: 'pnpm test'
    deps:
      - '~:build'
    inputs:
      - '@group(sources)'
      - '@group(tests)'

  clean:
    command: 'rm -rf dist node_modules/.cache'
