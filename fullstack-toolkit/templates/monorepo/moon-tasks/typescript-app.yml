# TypeScript Application Tasks
# Inherited by all TypeScript applications

extends: './_shared.yml'

inheritedBy:
  toolchains: ['typescript']
  layers: ['application']

implicitInputs:
  - 'package.json'

tasks:
  dev:
    command: 'pnpm dev'
    local: true

  build:
    command: 'pnpm build'
    inputs:
      - '@group(ts-sources)'
      - '@group(ts-configs)'
      - '@group(assets)'
    outputs:
      - 'dist'
      - '.next'
      - 'build'

  start:
    command: 'pnpm start'
    deps:
      - '~:build'

  lint:
    command: 'pnpm lint'
    inputs:
      - '@group(ts-sources)'

  typecheck:
    command: 'pnpm typecheck'
    inputs:
      - '@group(ts-sources)'
      - '@group(ts-configs)'

  test:
    command: 'pnpm test'
    inputs:
      - '@group(ts-sources)'
      - '@group(ts-tests)'

  clean:
    command: 'rm -rf dist .next build node_modules/.cache'
