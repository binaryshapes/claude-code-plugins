# TypeScript Application Tasks
# Inherited by all TypeScript applications (Moon v2)

inheritedBy:
  toolchains: ['typescript']
  layers: ['application']

fileGroups:
  sources:
    - 'src/**/*.{ts,tsx}'
    - 'app/**/*.{ts,tsx}'
    - 'components/**/*.{ts,tsx}'
    - 'lib/**/*.{ts,tsx}'
    - 'utils/**/*.{ts,tsx}'
  tests:
    - 'tests/**/*.{ts,tsx}'
    - '**/*.test.{ts,tsx}'
    - '**/*.spec.{ts,tsx}'
    - '__tests__/**/*.{ts,tsx}'
  configs:
    - 'tsconfig.json'
    - 'tsconfig.*.json'
    - '*.config.{ts,js,mjs,cjs}'
  assets:
    - 'public/**/*'
    - 'assets/**/*'
    - 'static/**/*'

implicitInputs:
  - 'package.json'

tasks:
  dev:
    command: 'pnpm dev'
    options:
      persistent: true

  build:
    command: 'pnpm build'
    inputs:
      - '@group(sources)'
      - '@group(configs)'
      - '@group(assets)'
    outputs:
      - 'dist/**/*'
      - '.next/**/*'
      - 'build/**/*'

  start:
    command: 'pnpm start'
    deps:
      - '~:build'

  lint:
    command: 'pnpm lint'
    inputs:
      - '@group(sources)'

  typecheck:
    command: 'pnpm typecheck'
    inputs:
      - '@group(sources)'
      - '@group(configs)'

  test:
    command: 'pnpm test'
    inputs:
      - '@group(sources)'
      - '@group(tests)'

  clean:
    command: 'rm -rf dist .next build node_modules/.cache'
